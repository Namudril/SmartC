<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style-try.css">

<script src="src/tokenizer.js"></script>
<script src="src/parser.js"></script>
<script src="src/verifier.js"></script>
<script src="src/shape.js"></script>
<script src="src/syntax.js"></script>
<script src="src/generator.js"></script>
<script src="src/testcases.js"></script>

<script>

function compileCode(){

    var codeString = document.getElementById("source-code").value;
    try{
        var token_output = tokenizer(codeString);
        var parser_output = parser(token_output);
        var ver_output = verify(parser_output);
        var big_ast = shapeProgram(ver_output);
        var big_ast_opTree = bigastProcessSyntax(big_ast);
        var asmCode = bigastCompile(big_ast_opTree);

        //document.getElementById("machine-code").innerHTML = asmCode+"\n\n"+asmCode.replace(/\n/g,"\\n")+"\n\n"+JSON.stringify(big_ast_opTree, null, '    ');
        //document.getElementById("machine-code").innerHTML = asmCode+"\n\n"+JSON.stringify(big_ast_opTree, null, '    ');
        document.getElementById("machine-code").innerHTML = asmCode;
    }catch (e) {
        document.getElementById("machine-code").innerHTML = e.message+"\n"+e.stack+JSON.stringify(big_ast_opTree, null, '    ');;
    }
}


function testCode() {
    document.getElementById("machine-code").innerHTML = runTestCases();    
}

</script>
</head>

<body>
    <h1>BurstAT-CC - Burstcoin AT C Compiler</h1>      
    <textarea id="source-code" placeholder="Write here your program." spellcheck="false"></textarea>
    
    <div>
        <button id="compile" onClick="javascript: compileCode();">Compile it!</button>
        <button id="test" onClick="javascript: testCode();">Run test cases</button>
    </div>
    <p>More information about this project, documentation or examples, visit <a href="https://deleterium.github.io/BurstAT-CC/">https://deleterium.github.io/BurstAT-CC/</a> or
    <a href="https://github.com/deleterium/BurstAT-CC">https://github.com/deleterium/BurstAT-CC</a></p>
    <pre id="machine-code" height="400" contenteditable="true" spellcheck="false"></pre>
</body>
</html>
